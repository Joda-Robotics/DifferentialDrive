WindowManager:
    LoginWindow:
    RegisterWindow:
    MainWindow:
    RobotOneWindow:

<LoginWindow>:
    name: "login"

    loginUsername: loginUsername
    loginPassword: loginPassword

    FloatLayout:
        size_hint: 1,1

        Label:
            text: "JODA"
            size_hint: .5,.1
            pos_hint: {"top":1}

        Label:
            text: "Login Screen"
            size_hint: .5,.1
            pos_hint: {"x":.5,"top":1}

        Label:
            text: "Please login or create an account to continue"
            size_hint: 1, .1
            pos_hint: {"x":0,"top":.9}

        Label:
            text: "Enter Username:"
            size_hint: .5, .2
            pos_hint: {"x":0, "top":.8}

        TextInput:
            id: loginUsername
            multiline: False
            size_hint: .5, .2
            pos_hint: {"x":.5,"top":.8}

        Label:
            text: "Enter Password:"
            size_hint: .5,.2
            pos_hint: {"x":0,"top":.6}

        TextInput:
            id: loginPassword
            multiline: False
            size_hint: .5, .2
            pos_hint: {"x":.5,"top":.6}

        Button:
            id: loginAttemptLoginButton
            text: "Login"
            size_hint: 1, .2
            pos_hint: {"x":0,"top":.4}
            on_release: 
                print("Attempting to login")
                root.login()
                root.reset()
                if root.allowAccess == 1 : app.root.current = "main"

        Button:
            id: loginGoToRegisterButton
            text: "Register"
            size_hint: .5, .2
            pos_hint: {"x":0,"top":.2}
            on_release: 
                print("Going to register screen")
                app.root.current = "register"
                root.manager.transition.direction = "right"

        Button:
            id: loginQuitButton
            text: "Quit"
            size_hint: .5, .2
            pos_hint: {"x":.5,"top":.2}
            on_release: 
                print("quit")
                quit()
   
<RegisterWindow>:
    name: "register"

    registerDesiredUsername: registerDesiredUsername
    registerPassword1: registerPassword1
    registerPassword2: registerPassword2

    FloatLayout:
        size_hint: 1,1

        Label:
            text: "JODA"
            size_hint: .5,.1
            pos_hint: {"top":1}

        Label:
            text: "Register Screen"
            size_hint: .5,.1
            pos_hint: {"x":.5,"top":1}

        Label:
            text: "Please register here"
            size_hint: .5, .1
            pos_hint: {"x":0,"top":.9}

        Button:
            text: "Go back"
            size_hint: .5, .1
            pos_hint: {"x":.5,"top":.9}
            on_release:
                app.root.current = "login"
                root.manager.transition.direction = "right"
                print("Going back")

        Label:
            text: "Enter desired username:"
            size_hint: .5, .2
            pos_hint: {"x":0,"top":.8}

        TextInput:
            id: registerDesiredUsername
            multiline: False
            size_hint: .5, .2
            pos_hint: {"x":.5,"top":.8}

        Label:
            text: "Enter password:"
            size_hint: .5, .2
            pos_hint: {"x":0,"top":.6}

        TextInput:
            id: registerPassword1
            multiline: False
            size_hint: .5, .2
            pos_hint: {"x":.5,"top":.6} 

        Label:
            text: "Re-enter your password"
            size_hint: .5, .2
            pos_hint: {"x":0,"top":.4}

        TextInput:
            id: registerPassword2
            multiline: False
            size_hint: .5, .2
            pos_hint: {"x":.5,"top":.4}

        Label:
            text: "Tick box if you accept terms"
            size_hint: .25, .2
            pos_hint: {"x":0,"top":.2}

        CheckBox:
            id: registerTermsCheckbox
            size_hint: .25, .2
            pos_hint: {"x":.25,"top":.2}

        Button:
            id: registerAttemptRegisterButton
            disabled: False
            text: "Press to register"
            size_hint: .5, .2
            pos_hint: {"x":.5,"top":.2}
            on_release:
                print("Attempting to register")
                root.register()
                root.manager.transition.direction = "right"
                if root.allowReg == 1 : app.root.current = "login"

<MainWindow>:
    name: "main"
    on_pre_enter: root.getUserLabel()

    mainUsernameLabel: mainUsernameLabel

    FloatLayout:
        size_hint: 1,1

        Label:
            text: "JODA"
            size_hint: .5,.1
            pos_hint: {"top":1}

        Label:
            text: "Overview"
            size_hint: .5,.1
            pos_hint: {"x":.5,"top":1}

        Label:
            id: mainUsernameLabel
            text: root.useName
            size_hint: .5,.1
            pos_hint: {"top":.9}

        Button:
            text: "Logout"
            size_hint: .5,.1
            pos_hint: {"x":.5,"top":.9}
            on_release:
                root.endSession()
                app.root.current = "login"
                root.manager.transition.direction = "right"
        
        Label:
            text: "Name"
            size_hint: .2,.1
            pos_hint: {"top":.8}

        Label:
            text: "Status"
            size_hint: .2,.1
            pos_hint: {"x":.2,"top":.8}

        Label:
            text: "Manual"
            size_hint: .2,.1
            pos_hint: {"x":.4,"top":.8}

        Label:
            text: "Auto"
            size_hint: .2,.1
            pos_hint: {"x":.6,"top":.8}

        Label:
            text: "Details"
            size_hint: .2,.1
            pos_hint: {"x":.8,"top":.8}

        Button:
            text: "Robot 1"
            size_hint: .2,.1
            pos_hint: {"x":0,"top":.7}

        Button:
            text: "Okay"
            size_hint: .2,.1
            pos_hint: {"x":.2,"top":.7}

        Button:
            text: "Manual Control"
            size_hint: .2,.1
            pos_hint: {"x":.4,"top":.7}
            on_release:
                app.root.current = "rone"
                root.manager.transition.direction = "right"

        Button:
            text: "Auto Control"
            size_hint: .2,.1
            pos_hint: {"x":.6,"top":.7}

        Button:
            text: "More Details"
            size_hint: .2,.1
            pos_hint: {"x":.8,"top":.7}

        Button:
            text: "Robot 2"
            size_hint: .2,.1
            pos_hint: {"x":0,"top":.6}

        Button:
            text: "Okay"
            size_hint: .2,.1
            pos_hint: {"x":.2,"top":.6}

        Button:
            text: "Manual Control"
            size_hint: .2,.1
            pos_hint: {"x":.4,"top":.6}

        Button:
            text: "Auto Control"
            size_hint: .2,.1
            pos_hint: {"x":.6,"top":.6}

        Button:
            text: "More Details"
            size_hint: .2,.1
            pos_hint: {"x":.8,"top":.6}

<RobotOneWindow>:
    name: "rone"

    FloatLayout:
        size_hint: 1,1
        pos_hint: {"x":0,"top":1}

        Button:
            text: "CAMERA"
            size_hint: 1,.5
            pos_hint: {"x:":0,"top":1}

        GridLayout:
            cols: 3
            size_hint: .4,.5
            pos_hint: {"x":0,"top":.5}

            Button:
                text: "On"
                on_press: root.robotServerInstanceStart()
            Button:
                text: "Forward"
                on_press: root.moveF()
                on_release: root.moveStop()
            Button:
                text: "Off"
                on_press: root.robotServerInstanceStop()
            Button:
                text: "Left"
                on_press: root.moveL()
                on_release: root.moveStop()
            Button:
                text: "Back"
                on_press: root.moveB()
                on_release: root.moveStop()
            Button:
                text: "Right"
                on_press: root.moveR()
                on_release: root.moveStop()
            Button:
                text: "Lights"
                on_press: root.testP()


        GridLayout:
            cols: 1
            size_hint: .1,.5
            pos_hint: {"x":.5, "top":.5}

            Slider:
                id: maxSpeed
                min:0
                max: 100
                step:1
                orientation: "vertical"

        GridLayout:
            cols: 2
            size_hint: .4,.5
            pos_hint: {"x":.6,"top":.5}

            Button:
                text: "Current Speed:"
            Label:
                text: "0"
            Button:
                text: "max speed allowed:"
            Label:
                text: str(maxSpeed.value)

            Button:
                text: "US Distance front"
                on_press: root.getUSDistanceF()
            Label:
                text: "0"
            Button:
                text: "US Distance back"
            Label:
                text: "0"

            Button:
                text: "End session"
                on_release:
                    app.root.current = "main"
                    root.manager.transition.direction = "right"